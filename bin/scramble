#!/usr/bin/env node

const yargs = require('yargs')
  .usage('Usage: $0 <type> [number]')
  .command('l', 'list scramblers')
  .alias('list');

const argv = yargs.argv;

const Scramblers = require('../').Scramblers;

if (argv.l) {
  Object.values(Scramblers.scramblers).forEach(scrambler => {
    console.log(scrambler.name, scrambler.description);
  });
  return;
}

const readline = require('readline');

readline.emitKeypressEvents(process.stdin);
process.stdin.setRawMode(true);

const args = yargs.argv;

if (!args._[0]) {
  return yargs.showHelp();
}

const scrambler = Scramblers.get(args._[0]);
if (scrambler) {
  scrambler.init();
  console.log(scrambler.scramble(args._.slice(1)));

  process.stdin.on('keypress', function (str, key) {
    if (str === '\u0003') {
      process.exit();
    }
    process.stdout.write(scrambler.scramble(args._.slice(1)) + '\n');
  });
}

